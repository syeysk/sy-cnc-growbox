# Список команд гроубокса

Параметры:
- `V` - значение датчика либо исполнительного устройства
- `A` - код исполнительного устройства: 0 — увлажнитель, 1 — вытяжка, 2 — белый свет, 3 - дальний красный, 4 - синий свет
- `S` - код датчика: 0 - температура, 1- влажность
- `P` - номер периода: значение различается для автоматики
- `D` - длительность
- `B` - булево значение: 1 - истина, 0 - ложь.

Буква `E` выбрана для команд, чтобы не путать их с командами других ЧПУ-станков.


## Прочее

- [x] `E10` — возвращает OK.

## Рабочая поверхность

- [ ] `S10` - возвращает список рабочих поверхностей
- [ ] `S11 <desk>` - возвращает точки поверхности `desk`. Точки указаны в милиметрах, выглядят как `XN YN ZN`
- [ ] `S12 <desk> <height> <point1> <pointN>` — добавляет точки поверхности `desk`. Возвращает код добавленной поверхности
- [ ] `S13 <desk> <height> <point1> <pointN>` — редактирует точки существующей поверхности `desk`
- [ ] `S14 <desk>` — удаляет поверхность `desk`.


## Добавление датчиков и исполнительных устройств

- [ ] `S0 <model_actuator> <type> <protocol> <address>` - добавляет исполнительное устройство типа `model_actuator` с протоколом `protocol` и адресом `address`. Возвращает назначенный устройству номер. `type` - параметр микроклимата, с которым работает устройство. 
- [ ] `S1 <model_sensor> <type> <protocol> <address>` - добавляет датчик типа `model_sensor` с протоколом `protocol` и адресом `address`.  Возвращает назначенный датчику номер. `type` - параметр микроклимата, который измеряет датчик
- [ ] `S2 <actuator> <protocol> <address>` - обновляет протокол `protocol` и адрес `address` исполнительного устройства с номером `actuator`.
- [ ] `S3 <sensor> <protocol>  <address>` - обновляет протокол `protocol` и адрес `address` датчика с номером `sensor`.
- [ ] `S4 <actuator>` - возвращает данные исполнительного устройства `actuator`, установленные командой `S0` или `S2`
- [ ] `S5 <sensor>` - возвращает данные датчика `sensor`, установленные командой `S1` или `S3`
- [ ] `S6 <actuator>` - удаляет исполнительное устройство `actuator`
- [ ] `S7 <sensor>` - удаляет датчик `sensor`
- [ ] `S8` - возвращает список исполнительных устройств
- [ ] `S9` - возвращает список датчиков

Поддерживаемые протоколы:
- цифровой вывод — адресом выступает номер порта. Значение подаётся напрямую в функции write/read
- аналоговый вывод — адресом выступает номер порта. Значение подаётся напрямую в функции analogWrite/analogRead
- 1-Wire – адресом выступает номер порта
- I2C – адресом выступает адрес устройства на шине.

## Датчики и исполнительные устройства, общие команды

- [x] `E0 A<actuator> V<value>` - устанавливает значение `value` на исполнительном устройстве `actuator`.
- [ ] `E1 A<actuator>` - возвращает значение, установленное на исполнительном устройстве `actuator`
- [x] `E2 S<sensor>` - возвращает значение с датчика `sensor`
- [x] `E3` - выключает все виды автоматики для всех исполнительных устройств
- [ ] `E4 V<minutes_stop> V<minutes_start>` - остановить выполнение алгоритмов через `minutes_stop` минут и начать заново через `minutes_start` минут. При старте все счётчики минут и периодов обнулятся (для вида привязки - 0)
- [ ] `E5 V<type>` - установить вид привязки отчёта времени: 0 - хронология от начала старта, 1 - привязка ко времени
- [ ] `E51` - возвращает текущий вид привязки
- [ ] `E6` - сбросить значения хронологии (для вида привязки - 0)
- [ ] `E7` - получить кол-во секунд, прошедших с момента запуска (для вида привязки - 0)
- [ ] `E8` - установить время (для вида привязки - 1)
- [ ] `E9` - получить текущее время (для вида привязки - 1)

## Циклическая автоматика с резким переключением периода

- [x] `E100 A<actuator> B<off_or_on>` - включает/отключает автоматику для исполнительного устройства `actuator`
- [x] `E1001 A<actuator>` - возвращает 1, если автоматика для исполнительного устройства `actuator` включена , иначе - 0.
- [x] `E101 A<actuator> B<part_of_period> D<duration>` - устанавливает длительность периода `duration` для исполнительного устройства `actuator`. `part_of_period` - равен 1 для длительности включённого состояния, равен 0 для длительности отключённого состояния
- [x] `E1011 A<actuator> B<part_of_period>` - возвращает длительность периода `part_of_period`, установленную командой `E101`
- [x] `E102 A<actuator>` - возвращает текущее период и сколько уже он длится в минутах
- [x] `E103 A<actuator> B<part_of_period> V<value>` - устанавливает значение `value` исполнительного устройства для периода `part_of_period`.
- [x] `E1031 A<actuator> B<part_of_period>` - возвращает значение `value` для периода `part_of_period`.

## Циклическая автоматика с плавной сменой периода

- [x] `E150 A<actuator> B<off_or_on>` - включает/отключает автоматику
- [x] `E1501 A<actuator>` - возвращает 1, если автоматика для исполнительного устройства `actuator` включена , иначе - 0.
- [x] `E151 A<actuator> P<part_of_day> D<duration>` - устанавливает световую длительность `duration` времени суток `part_of_day` в минутах. Времён суток всего 4: рассвет - 0, день - 1, закат - 2, ночь - 3.
- [x] `E1511 A<actuator> P<part_of_day>` - возвращает длительность времени суток `part_of_day`, установленную командой `E151`
- [x] `E152 A<actuator>` - возвращает текущее время суток и сколько уже оно длится в минутах
- [x] `E153 A<actuator> P<part_of_day> V<value>` - устанавливает значение `value` датчика для времени суток `part_of_day`. Допустимы следующие времена суток: день, ночь. Температура для рассвета и заката расчитывается автоматически и является плавным переходом между днём и ночью.
- [x] `E1531 A<actuator> P<part_of_day>` - возвращает уровень освещённости `value_lumen` для времени суток `part_of_day`.

## Условная автоматика климат-контроля

- [x] `E200 A<actuator> B<off_or_on>` - включает/отключает автоматику
- [x] `E2001 A<actuator>` - возвращает 1, если автоматика для исполнительного устройства `actuator` включена , иначе - 0.
- [x] `E201 A<actuator> S<sensor>` - привязывает датчик `sensor` к исполнительному устройству `actuator`.
- [x] `E2011 A<actuator>` - возвращает датчик, привязанный командой `E201`.
- [x] `E202 A<actuator> V<min_value>` - устанавливает минимальное допустимое значение на привязанном сенсоре, при котором автоматика включит исполнительное устройство.
- [x] `E2021 A<actuator>` - возвращает минимальное допустимое значение, установленное командой `E202`.
- [x] `E203 A<actuator> V<max_value>` - устанавливает максимальное допустимое значение на привязанном сенсоре, при котором автоматика выключит исполнительное устройство.
- [x] `E2031 A<actuator>` - возвращает максимальное допустимое значение, установленное командой `E203`.

## Показатели окружающей среды снаружи гроубокса

Буква E означает External

- `E1` - возвращает температуру
- `E2` - возвращает освещённость
- `E3` - возвращает влажность
- `E4` - возвращает уровень CO2
- `E5` - возвращает уровень кислорода
- `E6` -  возвращает скорость ветра (измеряется анемометром)